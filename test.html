<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ポイントアンケート（32問版）</title>

<!-- ===== デザイン ===== -->
<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');
:root{
  --primary:#4f46e5;
  --primary-light:#6366f1;
  --danger:#ef4444;
  --bg:#f7f8fc;
  --card:#ffffff;
  --text:#333;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:"Roboto",sans-serif;
  background:var(--bg);
  color:var(--text);
  line-height:1.6;
}
/* ── 固定ヘッダー ── */
#topbar{
  position:sticky;
  top:0;
  z-index:1000;
  background:var(--card);
  padding:.6em 1em;
  display:flex;
  justify-content:center;
  box-shadow:0 2px 4px rgba(0,0,0,.08);
  font-weight:700;
}
#remaining{color:var(--primary);}
/* ── セクションタイトル ── */
.section{
  margin:1.8em 0 .8em;
  font-size:1.25em;
  font-weight:700;
  color:var(--primary);
}
/* ── 質問カード ── */
.question{
  background:var(--card);
  border-radius:8px;
  padding:1em;
  margin:.6em 0;
  box-shadow:0 1px 3px rgba(0,0,0,.05);
}
.question p{margin:.2em 0 1em;font-weight:700;}
.question label{margin-right:1em;cursor:pointer;}
.question input[type=radio]{accent-color:var(--primary);margin-right:.25em;}
.textbox{
  display:none;
  width:100%;
  margin-top:.6em;
  padding:.55em .8em;
  border:1px solid #ccc;
  border-radius:4px;
  font-size:1em;
}
/* ── ボタン ── */
.btn{
  border:none;
  border-radius:6px;
  padding:.65em 1.4em;
  font-size:1em;
  font-weight:700;
  color:#fff;
  background:var(--primary);
  cursor:pointer;
  transition:background .2s;
}
.btn:hover{background:var(--primary-light);}
.btn:disabled{opacity:.5;cursor:not-allowed;}
.actions{
  display:flex;justify-content:center;gap:1em;margin:2em 0;
}
/* ── 結果表示 ── */
#summary{
  white-space:pre-wrap;
  background:var(--card);
  border-radius:8px;
  padding:1.2em;
  margin:2em 0 4em;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
}
.error{color:var(--danger);font-weight:700;}
.hidden{display:none;}
</style>
</head>
<body>

<!-- ── 固定ヘッダー ── -->
<div id="topbar">
  残ポイント：<span id="remaining">20</span> / 20 pt
</div>

<form id="quiz">

<!-- ============ 質問（32問） ============ -->
<h2 class="section">項目1</h2>

<div class="question" data-q="1">
  <p>1. 質問タイトル 1</p>
  <label><input type="radio" name="q1" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q1" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q1" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q1" value="指定しない" data-pt="0">指定しない</label>
</div>

<div class="question" data-q="2">
  <p>2. 質問タイトル 2</p>
  <label><input type="radio" name="q2" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q2" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q2" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q2" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="3">
  <p>3. 質問タイトル 3</p>
  <label><input type="radio" name="q3" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q3" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q3" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q3" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<h2 class="section">項目2</h2>

<div class="question" data-q="4">
  <p>4. 質問タイトル 4</p>
  <label><input type="radio" name="q4" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q4" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q4" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q4" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="5">
  <p>5. 質問タイトル 5</p>
  <label><input type="radio" name="q5" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q5" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q5" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q5" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="6">
  <p>6. 質問タイトル 6</p>
  <label><input type="radio" name="q6" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q6" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q6" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q6" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<h2 class="section">項目3</h2>

<div class="question" data-q="7">
  <p>7. 質問タイトル 7</p>
  <label><input type="radio" name="q7" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q7" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q7" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q7" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="8">
  <p>8. 質問タイトル 8</p>
  <label><input type="radio" name="q8" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q8" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q8" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q8" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="9">
  <p>9. 質問タイトル 9</p>
  <label><input type="radio" name="q9" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q9" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q9" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q9" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<h2 class="section">項目4</h2>

<div class="question" data-q="10">
  <p>10. 質問タイトル 10</p>
  <label><input type="radio" name="q10" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q10" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q10" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q10" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="11">
  <p>11. 質問タイトル 11</p>
  <label><input type="radio" name="q11" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q11" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q11" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q11" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="12">
  <p>12. 質問タイトル 12</p>
  <label><input type="radio" name="q12" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q12" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q12" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q12" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<h2 class="section">項目5</h2>

<div class="question" data-q="13">
  <p>13. 質問タイトル 13</p>
  <label><input type="radio" name="q13" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q13" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q13" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q13" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="14">
  <p>14. 質問タイトル 14</p>
  <label><input type="radio" name="q14" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q14" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q14" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q14" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="15">
  <p>15. 質問タイトル 15</p>
  <label><input type="radio" name="q15" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q15" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q15" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q15" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<h2 class="section">項目6</h2>

<div class="question" data-q="16">
  <p>16. 質問タイトル 16</p>
  <label><input type="radio" name="q16" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q16" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q16" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q16" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="17">
  <p>17. 質問タイトル 17</p>
  <label><input type="radio" name="q17" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q17" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q17" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q17" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="18">
  <p>18. 質問タイトル 18</p>
  <label><input type="radio" name="q18" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q18" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q18" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q18" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<h2 class="section">項目7</h2>

<div class="question" data-q="19">
  <p>19. 質問タイトル 19</p>
  <label><input type="radio" name="q19" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q19" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q19" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q19" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="20">
  <p>20. 質問タイトル 20</p>
  <label><input type="radio" name="q20" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q20" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q20" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q20" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="21">
  <p>21. 質問タイトル 21</p>
  <label><input type="radio" name="q21" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q21" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q21" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q21" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<h2 class="section">項目8</h2>

<div class="question" data-q="22">
  <p>22. 質問タイトル 22</p>
  <label><input type="radio" name="q22" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q22" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q22" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q22" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="23">
  <p>23. 質問タイトル 23</p>
  <label><input type="radio" name="q23" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q23" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q23" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q23" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="24">
  <p>24. 質問タイトル 24</p>
  <label><input type="radio" name="q24" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q24" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q24" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q24" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<h2 class="section">項目9</h2>

<div class="question" data-q="25">
  <p>25. 質問タイトル 25</p>
  <label><input type="radio" name="q25" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q25" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q25" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q25" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="26">
  <p>26. 質問タイトル 26</p>
  <label><input type="radio" name="q26" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q26" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q26" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q26" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="27">
  <p>27. 質問タイトル 27</p>
  <label><input type="radio" name="q27" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q27" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q27" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q27" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<h2 class="section">項目10</h2>

<div class="question" data-q="28">
  <p>28. 質問タイトル 28</p>
  <label><input type="radio" name="q28" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q28" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q28" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q28" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="29">
  <p>29. 質問タイトル 29</p>
  <label><input type="radio" name="q29" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q29" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q29" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q29" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="30">
  <p>30. 質問タイトル 30</p>
  <label><input type="radio" name="q30" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q30" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q30" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q30" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<h2 class="section">項目11</h2>

<div class="question" data-q="31">
  <p>31. 質問タイトル 31</p>
  <label><input type="radio" name="q31" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q31" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q31" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q31" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<div class="question" data-q="32">
  <p>32. 質問タイトル 32</p>
  <label><input type="radio" name="q32" value="A" data-pt="1">A</label>
  <label><input type="radio" name="q32" value="B" data-pt="1">B</label>
  <label><input type="radio" name="q32" value="C" data-pt="2">C</label>
  <label><input type="radio" name="q32" value="指定しない" data-pt="0" checked>指定しない</label>
  <input class="textbox" type="text" placeholder="自由入力">
</div>

<!-- ============ ボタン ============ -->
<div class="actions">
  <button type="button" id="showSummary" class="btn">結果を表示</button>
  <button type="button" id="copySummary" class="btn">結果をコピー</button>
</div>
</form>

<!-- ============ 結果エリア ============ -->
<div id="summary" class="hidden"></div>

<!-- ===== ロジック ===== -->
<script>
const maxPoints = 20;
const quiz      = document.getElementById('quiz');
const remainEl  = document.getElementById('remaining');
const summaryEl = document.getElementById('summary');

/* 残ポイント更新 */
function updateRemaining(){
  const used = [...quiz.querySelectorAll('input[type=radio]:checked')]
                 .reduce((s,r)=>s + Number(r.dataset.pt),0);
  const remain = maxPoints - used;
  remainEl.textContent = remain;
  remainEl.style.color = remain < 0 ? 'var(--danger)' : 'var(--primary)';
}

/* ラジオ変更時 */
quiz.addEventListener('change', e=>{
  const qBox   = e.target.closest('.question');
  if(!qBox) return;
  const textbox = qBox.querySelector('.textbox');
  if(textbox){
    if(e.target.value === '指定しない'){
      textbox.style.display = 'none';
      textbox.value = '';
    }else{
      textbox.style.display = 'block';
      textbox.focus();
    }
  }
  updateRemaining();
});

/* 結果生成 */
function buildResult(){
  // 未選択チェック
  for(const q of quiz.querySelectorAll('.question')){
    if(!q.querySelector('input[type=radio]:checked')){
      const num = Number(q.dataset.q);
      const sec = Math.ceil(num/3);
      return {ok:false,msg:`ERROR: 未選択の項目があります。（項目${sec}　質問${String(num).padStart(2,'0')}）`};
    }
  }

  // ポイント計算
  const checked = [...quiz.querySelectorAll('input[type=radio]:checked')];
  const used    = checked.reduce((s,r)=>s + Number(r.dataset.pt),0);
  if(used > maxPoints){
    return {ok:false,msg:'ERROR: ポイント上限を超過しています'};
  }

  // 一覧表示
  const lines = checked.map(r=>{
    const q   = r.closest('.question');
    const num = q.dataset.q;
    const tb  = q.querySelector('.textbox');
    const txt = tb ? tb.value.trim() : '';
    return `${num}. ${r.value}${txt? ' / '+txt:''} (${r.dataset.pt}pt)`;
  });
  lines.push('----');
  lines.push(`合計ポイント: ${used} / ${maxPoints}`);
  return {ok:true,msg:lines.join('\n')};
}

/* 結果表示ボタン */
document.getElementById('showSummary').addEventListener('click', ()=>{
  const res = buildResult();
  summaryEl.textContent = res.msg;
  summaryEl.classList.toggle('error', !res.ok);
  summaryEl.classList.remove('hidden');
});

/* コピー */
document.getElementById('copySummary').addEventListener('click', ()=>{
  const res = buildResult();
  if(!res.ok){
    summaryEl.textContent = res.msg;
    summaryEl.classList.add('error');
    summaryEl.classList.remove('hidden');
    return alert('エラーがあるためコピーできません');
  }
  navigator.clipboard.writeText(res.msg)
    .then(()=>alert('結果をコピーしました'))
    .catch(()=>alert('コピーに失敗しました'));
  summaryEl.textContent = res.msg;
  summaryEl.classList.remove('error','hidden');
});

/* 初期残ポイント */
updateRemaining();
</script>
</body>
</html>